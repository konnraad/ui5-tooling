import{_ as e,c as i,o as s,a4 as a}from"./chunks/framework.CTuJIu02.js";const k=JSON.parse('{"title":"Migrate to v4","description":"","frontmatter":{},"headers":[],"relativePath":"updates/migrate-v4.md","filePath":"updates/migrate-v4.md"}'),o={name:"updates/migrate-v4.md"},t=a(`<h1 id="migrate-to-v4" tabindex="-1">Migrate to v4 <a class="header-anchor" href="#migrate-to-v4" aria-label="Permalink to &quot;Migrate to v4&quot;">‚Äã</a></h1><div class="tip custom-block"><p class="custom-block-title">In Development</p><p><strong>UI5 Tooling 4.0 has been released on July 24, 2024 üéâ</strong></p><p>Install the latest version in your projects via: <code>npm i --save-dev @ui5/cli@latest</code><br> And update your global install via <code>npm i --global @ui5/cli@latest</code></p><p>And find the announcement blog post here: <strong><a href="https://community.sap.com/t5/technology-blogs-by-sap/ui5-tooling-4-0/ba-p/13769578" target="_blank" rel="noreferrer">SAP Community: UI5 Tooling 4.0</a></strong></p></div><h2 id="ui5-2-x-compatibility" tabindex="-1">UI5 2.x Compatibility <a class="header-anchor" href="#ui5-2-x-compatibility" aria-label="Permalink to &quot;UI5 2.x Compatibility&quot;">‚Äã</a></h2><p><em>Also see the blog post <a href="https://community.sap.com/t5/open-source-blogs/introducing-openui5-2-x/ba-p/13580633" target="_blank" rel="noreferrer">SAP Community: Introducing OpenUI5 2.x</a></em></p><p>UI5 Tooling 4.0 is required for building UI5 2.x projects. The UI5 2.x framework libraries define Specification Version 4.0 and therefore can&#39;t be built using older UI5 Tooling versions.</p><p>For applications and libraries running with UI5 2.x, the use of Specification Version 4.0 is not enforced. It is highly recommended, however, since only then UI5 Tooling will ensure UI5 2.x compatibility of the generated bundles.</p><h2 id="node-js-and-npm-version-support" tabindex="-1">Node.js and npm Version Support <a class="header-anchor" href="#node-js-and-npm-version-support" aria-label="Permalink to &quot;Node.js and npm Version Support&quot;">‚Äã</a></h2><p>This release requires <strong>Node.js versions v20.11.0, v22.0.0, or higher</strong> as well as npm v8 or higher. Support for older Node.js releases has been dropped; their use will cause an error.</p><h2 id="specification-versions-support" tabindex="-1">Specification Versions Support <a class="header-anchor" href="#specification-versions-support" aria-label="Permalink to &quot;Specification Versions Support&quot;">‚Äã</a></h2><p>As with UI5 Tooling 3.x, all projects with Specification Versions 2.0 and higher are supported.</p><p>If a legacy specification version is detected, an automatic migration is attempted. Old projects might therefore still work, unless they have a non-standard configuration in their ui5.yaml.</p><h2 id="changes-for-projects" tabindex="-1">Changes for Projects <a class="header-anchor" href="#changes-for-projects" aria-label="Permalink to &quot;Changes for Projects&quot;">‚Äã</a></h2><div class="tip custom-block"><p class="custom-block-title">No changes for Specification Versions 2.x and 3.x</p><p>Projects defining <strong>Specification Version 2.x or 3.x</strong> are expected to be <strong>fully compatible with UI5 Tooling v4</strong></p><p>The following does not apply to them.</p></div><p>For projects defining the latest <strong>Specification Version 4.0 or higher</strong>, the following changes apply:</p><ul><li><p><strong>Breaking Change:</strong> Bundling of JavaScript modules requiring &quot;top level scope&quot; as a string is terminated.</p><p>In UI5 2.x, the feature of evaluating modules from a string is expected to be removed. Therefore, when using the latest Specification Version, UI5 Tooling will <strong>omit affected module from the bundle and log an error message instead.</strong></p><p>For more details, see <a href="./../pages/Builder.html#javascript-files-requiring-top-level-scope">Builder: JavaScript Files Requiring Top Level Scope</a>.</p></li><li><p><strong>Breaking Change:</strong> New <code>async</code> option for the <code>require</code> sections of bundle definitions.</p><p>This option defaults to <code>true</code> for Specification Version 4.0 and higher, <strong>which can influence the loading behavior of your project</strong>. Require sections are now expressed using <code>sap.ui.require</code> instead of <code>sap.ui.requireSync</code>. The latter is not available in UI5 2.x.</p><p>Note that the same default applies for all standard bundles as well, like the component- or library preloads as well as self-contained bundles.</p><p>See <a href="./../pages/Configuration.html#properties">Configuration: <code>bundleDefinition.sections</code></a> for more on the new <code>async</code> option.</p></li><li><p><strong>Breaking Change:</strong> Removal of the <code>usePredefineCalls</code> <a href="./../pages/Configuration.html#properties">bundle option</a>. UI5 Tooling v4 will <em>always</em> use <code>sap.ui.predefine</code> calls in bundles, making this option obsolete.</p><p><strong>We do not expect any negative impact</strong> on projects due to this change, therefore it is active independently of the Specification Version. However, when upgrading to Specification Version 4.0 you might need to remove the property if you have it in your ui5.yaml configuration.</p></li></ul><p>You can find a summary of the above at <a href="./../pages/Configuration.html#specification-version-40">Configuration: Specification Version 4.0</a>.</p><h2 id="migrate-your-code" tabindex="-1">Migrate Your Code <a class="header-anchor" href="#migrate-your-code" aria-label="Permalink to &quot;Migrate Your Code&quot;">‚Äã</a></h2><p>When using the Node.js API of UI5 Tooling, or when integrating it into other tools, the following changes might be relevant to you:</p><h3 id="changes-to-ui5-cli" tabindex="-1">Changes to @ui5/cli <a class="header-anchor" href="#changes-to-ui5-cli" aria-label="Permalink to &quot;Changes to @ui5/cli&quot;">‚Äã</a></h3><p>Occurrences of <code>console.log</code> in the code base are replaced with <code>process.stderr</code>. –êny scripts that capture the output from <code>console.log</code> need to be adjusted to rely on <code>process.stderr</code>.</p><h3 id="changes-to-ui5-fs" tabindex="-1">Changes to @ui5/fs <a class="header-anchor" href="#changes-to-ui5-fs" aria-label="Permalink to &quot;Changes to @ui5/fs&quot;">‚Äã</a></h3><p>Non-public <code>DuplexCollection#byGlobSource</code> API has been removed.</p><h3 id="changes-to-ui5-builder" tabindex="-1">Changes to @ui5/builder <a class="header-anchor" href="#changes-to-ui5-builder" aria-label="Permalink to &quot;Changes to @ui5/builder&quot;">‚Äã</a></h3><ul><li><p><strong>Bundling</strong>: The <code>usePredefineCalls</code> option has been removed. Bundling now enforces the use of <code>sap.ui.predefine</code> instead of function wrappers.</p></li><li><p><strong>Task API</strong>: The <code>namespace</code> option has been renamed to <code>projectNamespace</code>. For more information, check the documentation for <a href="./../pages/extensibility/CustomTasks.html#task-implementation">CustomTasks API</a></p></li><li><p><strong>New Option</strong>: Added a new <code>async</code> option for <code>builder.bundles.bundleDefinition.section</code>.</p></li></ul><div class="important custom-block github-alert"><p class="custom-block-title">Example</p><p></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">builder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">   bundles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">bundleDefinition</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">       name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;app.js&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">       sections</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">           - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">require</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">           filters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">some/app/Component.js</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">           resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">           sort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">           async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span></code></pre></div></div><h3 id="changes-to-ui5-project" tabindex="-1">Changes to @ui5/project <a class="header-anchor" href="#changes-to-ui5-project" aria-label="Permalink to &quot;Changes to @ui5/project&quot;">‚Äã</a></h3><p><strong>Default Workspace Name</strong>: The default <code>workspaceName</code> is now <code>&quot;default&quot;</code> for API usage.</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {graphFromPackageDependencies} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@ui5/project/graph&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">graphFromPackageDependencies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* workspaceName: &quot;default&quot; */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p><strong>Directory Naming</strong>: The <code>ui5HomeDir</code> has been renamed to <code>ui5DataDir</code> in APIs.</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Resolver </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@ui5/project/ui5Framework/Openui5Resolver&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Resolver.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resolveVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1.120.15&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ui5DataDir: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;~/.ui5&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cwd: process.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cwd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><ul><li><strong>Dependencies</strong>: The <code>@ui5/builder</code> is now an optional dependency to the <code>@ui5/project</code></li></ul><p>Consumers of the Node.js API that make use of the <code>ProjectGraph#build</code> method need to declare a dependency to <code>@ui5/builder</code> in their respective <code>package.json</code>. The package manager should ensure that the version fulfills the range specified in the <code>package.json</code> of <code>@ui5/project</code>.</p><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">‚Äã</a></h2><h3 id="app-stops-working-with-ui5-1-71" tabindex="-1">App Stops Working With UI5 1.71 <a class="header-anchor" href="#app-stops-working-with-ui5-1-71" aria-label="Permalink to &quot;App Stops Working With UI5 1.71&quot;">‚Äã</a></h3><p>This might be caused by a mismatch of your project&#39;s manifest version and your UI5 version.</p><p>UI5 Tooling v4 enhances the manifest.json with information about the <code>supportedLocales</code> (also see <a href="./../pages/Builder.html#generation-of-supported-locales">Builder: Generation of Supported Locales</a>). In UI5 1.71 this configuration is not supported and leads to an ambiguous error message <code>TypeError: invalid input</code> and a failure to process the manifest file.</p><p>UI5 Tooling uses the manifest&#39;s <code>_version</code> property to decide whether the <code>supportedLocales</code> can be generated. For UI5 1.71, only versions up to <code>1.17.0</code> are supported. See <a href="https://sdk.openui5.org/#/topic/be0cf40f61184b358b5faedaec98b2da" target="_blank" rel="noreferrer">UI5 Demo Kit: Descriptor for Applications, Components, and Libraries (manifest.json)</a> for a mapping per manifest version.</p><p>To resolve this issue, adjust the manifest version according to the UI5 version you are using.</p><p><em>This issue was first raised here: <a href="https://github.com/SAP/ui5-tooling/issues/988" target="_blank" rel="noreferrer">Ui5 Tooling #988</a></em></p>`,39),n=[t];function r(p,l,h,d,c,u){return s(),i("div",null,n)}const m=e(o,[["render",r]]);export{k as __pageData,m as default};
